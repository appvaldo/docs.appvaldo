---
title: "fail2ban"
date: "19/03/2022 20:02"
---


```bash
sudo apt install fail2ban
sudo nano /etc/fail2ban/jail.d/sshd.conf
```
```
[sshd]
enable = true
port = 22
filter = sshd
logpath = /var/log/auth.log
maxretry = 1
bantime = 86400
```
```bash
sudo systemctl restart fail2ban
sudo fail2ban-client status
sudo fail2ban-client status sshd
```

```bash
# log de ban
sudo cat /var/log/fail2ban.log
# verificando log
sudo tail /var/log/fail2ban.log
# ips bloqueados
iptables -L
# checando Servi√ßos
fail2ban-client status
```

- disable password ssh
```bash
sudo nano /etc/ssh/ssh_config

```
```
PasswordAuthentication no
PermitRootLogin no
port 3223
```

```bash
sudo /etc/init.d/ssh restart
service sshd restart
```

```bash
# firewall ufw
sudo nano /etc/default/ufw
IPV6=no
# set default rules
sudo ufw default deny incoming
sudo ufw default allow outgoing

sudo ufw allow ssh
sudo ufw allow 2122
sudo ufw allow 443
sudo ufw allow 80
sudo ufw delete 80
sudo ufw enable

sudo ufw status verbose
sudo ufw reset
sudo ufw disable

sudo systemctl reload ssh

# retirar regra pelo numero
sudo ufw status numbered
sudo ufw delete 4

